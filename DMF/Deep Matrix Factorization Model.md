# Deep Matrix Factorization Model

这是一篇发表于IJCAI2017的推荐系统的论文,论文的核心是利用显示反馈和隐式反馈结合的Deep矩阵分解方式来进行用户商品评分预测，作者这里强调是第一篇使用这种显示隐式结合的方式，同时为了更好的学习到这种用户对商品的购买偏好，作者重并没有使用常规的RMSE作为损失函数，作者认为这种损失函数只是单纯的考虑了用户对于评分的电影的喜好，并不能反映用户对于那些没有评分的电影的喜好情况。而我们知道LFM模型利用的是隐式反馈，即用户评过分的电影为1没有评分的为0这种0，1分布可以反映用户对于电影的喜好偏好。这种方式通常使用交叉熵作为损失函数，作者利用这种较差熵的形式同时对于评分进行最大值归一化这样用户的评分就能归一化到0-1之间。就能将这种显示的评分和隐式反馈结合起来，这种设计非常巧妙。



## 背景

基于CF的推荐是一种非常主流的推荐方式，这种推荐利用用户历史交互数据进行相似性学习，然后推荐跟这些相似的。MF是一种基于模型的CF其核心是学习一个latent space来表示用户商品的交互，然后用这个laent space来预测用户对商品的评分进行个性化推荐。这些基于评分的方式是利用一种显示反馈，但是这种显示反馈数据一半都非常的稀疏，未来克服这种问题，很多人尝试加入一些外部信息，例如加入评论信息，用户对商品一般都会有一些评论，这种文本信息加以处理可以表达用户的一种偏好(这个思路的文论有一个系列的工作)，还有就是用户相关的社交信息也可以加入。如果仅仅关注这些显示的信息进行topN推荐显然是不够的，那些用户购买或者没有显示反馈的数据也非常重要，关于深度学习进行推荐的工作越来越重要，特别是NCF的提出，这种利用MLP来学习用户和商品的，但是这些工作用到的是隐式反馈数据(NCF利用的是用户评过分的为正样本，没有评分的采样作为负样本)。并没有充分利用用户商品的显示反馈评分数据。

综合上述的工作，这里作者提出了一种合理利用显示隐式数据的深度学习模型DMF，同时为了能让这种方式能正常的工作，这里作者重新设计了一下损失函数，设计思路之前提到过。



## 模型设计

![](http://www.arvinzyy.cn/2017/08/05/DeepMatrixFactorizationModelsforRecommenderSystems/20170805001.png)

上图是模型的结构，这里作者使用的embedding是用户商品评分矩阵(u*i)，其中u代表用户embedding，i代表商品embedding然后分别将user embedding和item embedding放入一个多层神经网络中学习user low dimension 表示最后利用余玄相似度计算评分。

损失函数：
$$
Loss = -\sum_{(i,j)\in Y^+ \bigcup Y^-}{(\frac{Y_{ij}}{max(R)}log(\hat{Y_{ij}})+(1-\frac{Y_{ij}}{max(R)})log(1-\hat{Y_{ij}})}
$$
评价指标：这里作者使用的是NDCG和HR来评价模型

由于使用到NDCG这里需要采样多个负样本来进行排序预测

数据集：这里使用的是movielen1M数据，训练数据为每个用户的前n-1一个数据，测试数据为用户的最后一个评分数据，同时对其他用户没有评分的数据进行采样然后分别预测这些没有评分的数据的得分然后计算NDCG

